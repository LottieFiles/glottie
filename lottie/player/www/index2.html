<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<script src="https://unpkg.com/@lottiefiles/lottie-player@0.4.0/dist/lottie-player.js"></script>
</head>

<body>
    
    <script type='text/javascript'>
	function customLoad() {
		//loadJson('https://assets1.lottiefiles.com/packages/lf20_2UeWRZ.json')
		loadJson('https://assets6.lottiefiles.com/private_files/lf30_AGoC3n.json')
	}

	function loadJson(passedURL) {
		let url
		if (passedURL.length <= 0) {
			url = document.getElementById("theurl").value;
		} else {
			url = passedURL
		}
		http=new XMLHttpRequest();
		//if(params!=null) {
		//	http.open("POST", url, true);
		//	http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
		//} else {
			http.open("GET", url, true);
		//}
		http.onreadystatechange = function() {
			if(http.readyState == 4 && http.status == 200) {
				jsonLoaded(http.responseText);
			}
		}
		http.send();
	}

	function loadRawJson() {
		var thejson = document.getElementById('thejson').value
		jsonLoaded(thejson)
	}

	function jsonLoaded(thejson) {
		//const thejson = Array.from(document.getElementById('thejson').value);
		let buffer
		let error
		let result
		try {
			const typedArray = new Uint8Array(thejson.length)
			for (let i=0; i < thejson.length; i++) {
				typedArray[i] = thejson.charCodeAt(i)
				//console.log(typedArray[i])
			}
			buffer = Module._malloc(typedArray.length * typedArray.BYTES_PER_ELEMENT)
			Module.HEAP8.set(typedArray, buffer)
			result = Module.ccall("loadJson", null, ["number", "number", "number", "number", "number", "number"], [buffer, thejson.length, 1.0, 1.0, 1.0, 1.0])
		} catch (e) {
			error = e
		} finally {
			Module._free(buffer)
		}
		if (error) throw error
	}

	setTimeout(customLoad, 1000)
	//window.document.onLoad=function(){loadJson('https://assets4.lottiefiles.com/packages/lf20_KO70yq.json')}
    </script>


	<div style='display:inline-block; float: left;'>
    <!-- Create the canvas that the C++ code will draw into -->
    <canvas id="canvas" oncontextmenu="event.preventDefault()" style="border: 1px solid #000000;"></canvas>

    <!-- Allow the C++ to access the canvas element --> 
    <script type='text/javascript'>
        var canv = document.getElementById('canvas');
        var Module = {
            canvas: canv
        };
	var passedString = new String;
	//var urlToFetch = 'http://example.com/movies.json';
    </script>
    
    <!-- Call the javascript glue code (index.js) as generated by Emscripten -->
    <!--<script src="scaffolding.js"></script>-->
    <script src="player.js"></script>
    
    <!-- Allow the javascript to call C++ functions -->
    <script type='text/javascript'>
        canv.addEventListener('click',    _toggle_background_color, false);
        canv.addEventListener('touchend', _toggle_background_color, false);
    </script>
	</div>

	<div style='display:inline-block; float: left;'>
<lottie-player
  autoplay
  controls
  loop
  mode="normal"
  src="https://assets6.lottiefiles.com/private_files/lf30_AGoC3n.json"
>
</lottie-player>
	</div>

</body>

</html>

